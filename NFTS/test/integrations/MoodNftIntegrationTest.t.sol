//SPDX-License-Identifier:MIT
pragma solidity ^0.8.20;

import {Test, console} from "forge-std/Test.sol";
import {MoodNft} from "../../src/MoodNft.sol";
import {deployMoodNft} from "../../script/deployMoodNft.s.sol";

contract MoodNftTest is Test{
    MoodNft moodnft;
    string public constant happy_svg_uri = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/Pgo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDIwMDEwOTA0Ly9FTiIKICJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy1TVkctMjAwMTA5MDQvRFREL3N2ZzEwLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4wIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiB3aWR0aD0iNzk2LjAwMDAwMHB0IiBoZWlnaHQ9IjY2NC4wMDAwMDBwdCIgdmlld0JveD0iMCAwIDc5Ni4wMDAwMDAgNjY0LjAwMDAwMCIKIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIG1lZXQiPgoKPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsNjY0LjAwMDAwMCkgc2NhbGUoMC4xMDAwMDAsLTAuMTAwMDAwKSIKZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSJub25lIj4KPHBhdGggZD0iTTM5NTUgNjAwNCBjLTY1NSAtNjcgLTExNzcgLTMwOCAtMTYxNCAtNzQ1IC0zOTkgLTQwMCAtNjM4IC04NzgKLTcyOCAtMTQ1OSAtMjUgLTE2MSAtMjUgLTUzOSAwIC03MDAgOTAgLTU4MSAzMjkgLTEwNTkgNzI4IC0xNDU5IDQwMCAtMzk5Cjg3OCAtNjM4IDE0NTkgLTcyOCAxNjEgLTI1IDUzOSAtMjUgNzAwIDAgNTgxIDkwIDEwNTkgMzI5IDE0NTkgNzI4IDM5OSA0MDAKNjM4IDg3OCA3MjggMTQ1OSAyNSAxNjEgMjUgNTM5IDAgNzAwIC05MCA1ODEgLTMyOSAxMDU5IC03MjggMTQ1OSAtMzk3IDM5NgotODgwIDYzOSAtMTQ0OSA3MjYgLTEwMSAxNSAtNDY4IDI4IC01NTUgMTl6IG01MzUgLTE2OSBjNTg4IC04OSAxMTM0IC0zOTMKMTUwMyAtODM3IDI5OSAtMzYxIDQ4MyAtNzgzIDU0OCAtMTI1OCAxNyAtMTIyIDE3IC00NTggMCAtNTgwIC0zOCAtMjgwIC0xMTQKLTUzMyAtMjMxIC03NjkgLTI0NCAtNDkwIC02MTEgLTg1OCAtMTEwMCAtMTEwMCAtMjMzIC0xMTUgLTQ2MiAtMTg3IC03MzAKLTIyOCAtMTU5IC0yNCAtNTAxIC0yNCAtNjYwIDAgLTU0MCA4MyAtOTk1IDMxMCAtMTM3MSA2ODYgLTM3NiAzNzYgLTYwMyA4MzEKLTY4NiAxMzcxIC0yNCAxNTkgLTI0IDUwMSAwIDY2MCA4MyA1NDAgMzEwIDk5NSA2ODYgMTM3MSA0MTEgNDExIDkyNSA2NDgKMTUyMSA3MDMgOTEgOCA0MTggLTQgNTIwIC0xOXoiLz4KPHBhdGggZD0iTTQ2NjUgNDg3NyBjLTE5OCAtNjUgLTMwOCAtMjcwIC0yNTAgLTQ2NSAyNCAtODEgODcgLTEwOCAxMzUgLTU3IDIwCjIxIDIyIDMwIDE1IDY3IC0xNCA3MCAtMTAgMTYwIDcgMTkzIDM5IDc1IDEyMCAxMjQgMjAxIDEyNSA4NiAwIDE1MiAtNDEgMjAzCi0xMjcgMzggLTY2IDExMyAtNzEgMTQyIC0xMCAyOSA2MSAtNzAgMTk3IC0xODUgMjUzIC00NiAyMyAtNzMgMjkgLTE0MiAzMQotNTIgMiAtMTAyIC0yIC0xMjYgLTEweiIvPgo8cGF0aCBkPSJNNTY1MCA0NTc5IGMtMTgyIC0zNiAtMzI3IC0yMDMgLTMzOCAtMzkwIC04IC0xMzAgMzIgLTIzNCAxMjQgLTMyNgoxNDYgLTE0NyAzODMgLTE2NSA1NDUgLTQzIDY1IDQ5IDEwMyA5NSAxMzQgMTYzIDY4IDE0OSA1MSAzMTUgLTQ2IDQzNyAtNDIgNTQKLTcxIDYyIC0xMjMgMzkgLTIwIC0xMCAtMzAgLTkgLTQ5IDQgLTEzIDggLTQyIDIxIC02NCAyNyAtMzEgMTAgLTQyIDE5IC01Mgo0NSAtOCAyMyAtMjEgMzcgLTQzIDQ0IC0xNyA2IC0zNCAxMSAtMzcgMTAgLTMgLTEgLTI2IC01IC01MSAtMTB6IG0xMjkgLTE5MQpjNzMgLTk4IDEzNCAtMjQ1IDE0NyAtMzU2IDcgLTY1IDEgLTczIC03MyAtMTEyIC0xMDQgLTU0IC0yMzMgLTMwIC0zMTYgNTkKLTE0MiAxNTEgLTY5IDM5MCAxMzQgNDQ1IDMwIDggNTcgMTUgNjEgMTUgNCAxIDI1IC0yMyA0NyAtNTF6Ii8+CjxwYXRoIGQ9Ik0yODY3IDQxMzAgYy0xOTcgLTUwIC0zMjQgLTI1OCAtMjc3IC00NTQgMTQgLTYxIDI4IC04MiA2MSAtOTUgMzIKLTEyIDg1IDEwIDk0IDM5IDQgMTIgMSA1MSAtNiA4NiAtMjYgMTMzIDM4IDI0MCAxNjQgMjc1IDg3IDI0IDE5OCAtMjYgMjQ3Ci0xMTEgNDYgLTc5IDExNSAtODcgMTQ4IC0xNyAxMiAyNiAxMSAzNCAtMTMgODIgLTM0IDcxIC0xMTggMTQ3IC0xOTMgMTc1IC02NQoyNSAtMTY5IDM0IC0yMjUgMjB6Ii8+CjxwYXRoIGQ9Ik00OTk4IDM5MzAgYy05IC02IC0yOSAtNDMgLTQ0IC04MyAtNzUgLTIwMSAtMTgwIC0zNTUgLTMzMiAtNDkwCi0yMjIgLTE5OCAtNDU1IC0yOTIgLTc1MyAtMzA0IC0yMTMgLTggLTM3NyAyMyAtNTcyIDExMSAtMzIgMTQgLTY4IDI2IC04MSAyNgotMzEgMCAtNjYgLTQwIC02NiAtNzYgMCAtNTMgNDggLTgzIDIyOSAtMTQ1IDY5OCAtMjM5IDE0NzQgMTM1IDE3MTcgODI4IGwyOQo4MiAtMjEgMjggYy0yMyAzMCAtNzUgNDIgLTEwNiAyM3oiLz4KPHBhdGggZD0iTTI0MjEgMzI0NCBjLTIxMSAtNTcgLTM0OSAtMjY3IC0zMTIgLTQ3NSA0NSAtMjU3IDI5OCAtNDE1IDU0MyAtMzM5CjI3NCA4NCAzODUgNDA5IDIyMiA2NDcgLTQyIDYxIC03NiA3NyAtMTIyIDU3IC0yOSAtMTIgLTM3IC0xMSAtODUgMTEgLTI4IDE0Ci02MCAyNSAtNjkgMjUgLTEyIDAgLTE4IDggLTE4IDI0IDAgMzEgLTQzIDY2IC03OSA2NSAtMTQgMCAtNTAgLTcgLTgwIC0xNXoKbTE0NyAtMTgwIGM3OCAtOTIgMTU3IC0yOTQgMTUwIC0zODYgLTMgLTM3IC04IC00NiAtNDMgLTY5IC04NiAtNTggLTIwOSAtNTgKLTI5OCAyIC0xNjUgMTA5IC0xNTUgMzUyIDE5IDQ1OSAyNyAxNyA2NiAyOSAxMjYgMzkgMyAxIDI0IC0yMCA0NiAtNDV6Ii8+CjxwYXRoIGQ9Ik00MzkwIDI4NjAgYy0zNiAtMTYgLTc1IC0zOCAtODcgLTQ5IC00OCAtNDEgLTE2IC0xMjEgNDcgLTEyMSA0NCAwCjE3OCA1OSAyMDEgODggMjQgMzIgMjQgNTMgLTIgODYgLTI3IDM0IC03MyAzMyAtMTU5IC00eiIvPgo8L2c+Cjwvc3ZnPgo=";
    string public constant sad_svg_uri = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/Pgo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDIwMDEwOTA0Ly9FTiIKICJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy1TVkctMjAwMTA5MDQvRFREL3N2ZzEwLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4wIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiB3aWR0aD0iNjMyLjAwMDAwMHB0IiBoZWlnaHQ9IjYxOC4wMDAwMDBwdCIgdmlld0JveD0iMCAwIDYzMi4wMDAwMDAgNjE4LjAwMDAwMCIKIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIG1lZXQiPgoKPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsNjE4LjAwMDAwMCkgc2NhbGUoMC4xMDAwMDAsLTAuMTAwMDAwKSIKZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSJub25lIj4KPHBhdGggZD0iTTI5NTUgNTY2OSBjLTg4IC04IC0zMTQgLTQ5IC0zODcgLTY5IC00MyAtMTIgLTY4IC00MiAtNjggLTgxIDAgLTMzCjM1IC03OSA2MSAtNzkgMTAgMCA4NSAxMyAxNjYgMzAgNTI3IDEwNiAxMDQ1IDM3IDE1MTYgLTIwMiA0NDkgLTIyOCA4MTQgLTU5NwoxMDMyIC0xMDQzIDI1MSAtNTE1IDMwOCAtMTA2NyAxNjUgLTE2MTkgLTIwOSAtODExIC04NTUgLTE0NTMgLTE2NzQgLTE2NjEKLTIwOSAtNTMgLTM0MyAtNjkgLTU3MSAtNjkgLTM3OCAwIC02OTIgNzMgLTEwMzEgMjM5IC02ODQgMzM2IC0xMTUyIDk4MwotMTI3MSAxNzU1IC0yMSAxNDEgLTI0IDQ5MCAtNSA2MjUgNzYgNTMxIDMxMiAxMDAwIDY4NiAxMzYyIDE4NSAxODEgMzU3IDMwMwo1ODMgNDE3IDYxIDMwIDExMyA2MiAxMTcgNzEgMjAgNTIgLTYgMTA5IC01NCAxMjAgLTUxIDEyIC0zMjkgLTE0MiAtNTMwIC0yOTMKLTEzMCAtOTggLTMzNiAtMjk4IC00MzAgLTQxNyAtMjI1IC0yODUgLTM5NCAtNjI5IC00NzkgLTk3NiAtNDMgLTE3OSAtNjEKLTMxMCAtNjcgLTUwOSAtMzQgLTk5OSA1NDEgLTE5MjAgMTQ1NiAtMjMzNSA4NjkgLTM5NCAxODgwIC0yNTcgMjYxNCAzNTQgNDgwCjM5OSA3OTggOTg1IDg3NSAxNjA5IDkzIDc1MiAtMTcxIDE1MTYgLTcwOSAyMDUyIC01MjcgNTI2IC0xMjU2IDc4OCAtMTk5NQo3MTl6Ii8+CjxwYXRoIGQ9Ik0yMTEwIDMyNjAgYy0yOCAtMjggLTMzIC01OSAtMjAgLTEzMCAyNCAtMTMyIDgyIC0yMTAgMTk4IC0yNjcgNzIKLTM2IDgxIC0zOCAxNzEgLTM4IDg3IDAgMTAyIDMgMTYxIDMxIDM2IDE3IDgyIDQ1IDEwMSA2MiA3NiA2NyAxMzcgMjQzIDEwOQozMTMgLTIyIDUyIC03NyA2NSAtMTIyIDI5IC0yMCAtMTUgLTI3IC0zMyAtMzIgLTc0IC0xNSAtMTE3IC05NiAtMTg5IC0yMTEKLTE4OSAtMTI1IDAgLTIyNSA5NSAtMjI1IDIxNSAwIDU2IC04OSA4OSAtMTMwIDQ4eiIvPgo8cGF0aCBkPSJNMzU3MCAzMjYwIGMtMjggLTI4IC0zMyAtNTkgLTIwIC0xMzAgMjQgLTEzMiA4MiAtMjEwIDE5OCAtMjY3IDcyCi0zNiA4MSAtMzggMTcxIC0zOCA4NyAwIDEwMiAzIDE2MSAzMSAzNiAxNyA4MiA0NSAxMDEgNjIgNzYgNjcgMTM3IDI0MyAxMDkKMzEzIC0yMiA1MiAtNzcgNjUgLTEyMiAyOSAtMjAgLTE1IC0yNyAtMzMgLTMyIC03NCAtMTUgLTExNyAtOTYgLTE4OSAtMjExCi0xODkgLTEyNSAwIC0yMjUgOTUgLTIyNSAyMTUgMCA1NiAtODkgODkgLTEzMCA0OHoiLz4KPHBhdGggZD0iTTMyNzcgMjI3NSBjLTE5MyAtMzcgLTQyNyAtMTYxIC02MzcgLTMzOCAtNjUgLTU0IC03NSAtNjggLTc4IC05OQotMyAtMjkgMiAtNDAgMjggLTYyIDE3IC0xNCA0MCAtMjYgNTAgLTI2IDEwIDAgNTcgMjkgMTAzIDY0IDM4NCAyOTMgNjkyIDM4MAo5MjUgMjYyIDI4IC0xNCA2NSAtMjYgODEgLTI2IDUwIDAgODUgNjIgNjUgMTE1IC04IDIxIC0xMDAgNjcgLTE4OSA5NCAtOTIgMjkKLTI0MyAzNiAtMzQ4IDE2eiIvPgo8L2c+Cjwvc3ZnPgo=";
    address USER = makeAddr("user");
    deployMoodNft deployer;

    function setUp() public{
        deployer = new deployMoodNft();
        moodnft = deployer.run();
    }

    function testViewTokenUriIntegration() public {
        vm.prank(USER);
        moodnft.mintNft();
        console.log(moodnft.tokenURI(0));
    }

    function testFlipFromDefaultToSad() public{
        vm.startPrank(USER);
        moodnft.mintNft();
        moodnft.flipMood(0);
        vm.stopPrank();

        console.log(moodnft.tokenURI(0));
        assert(moodnft.getMoodFromId(0) == MoodNft.MOOD.SAD);
    }

    function testIfMoodFlipsFromSadToHappy() public{
        vm.startBroadcast(USER);
        moodnft.mintNft();
        moodnft.flipMood(0);
        moodnft.flipMood(0);
        vm.stopPrank();

        console.log(moodnft.tokenURI(0));
        assert(moodnft.getMoodFromId(0) == MoodNft.MOOD.HAPPY);
    }
}